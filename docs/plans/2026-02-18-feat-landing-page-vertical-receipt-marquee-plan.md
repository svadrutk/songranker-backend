---
title: feat: Landing Page Vertical Receipt Marquee
type: feat
status: completed
date: 2026-02-18
---

# feat: Landing Page Vertical Receipt Marquee

## Overview

Implement a visually striking Vertical Marquee (Parallax) animation for the landing page that displays multiple "receipts" generated by our existing backend. This feature aims to add a modern, high-fidelity aesthetic to the product's entry point, showcasing the core "Receipt" visual in a dynamic, scrolling background.

## Problem Statement / Motivation

The current landing page lacks a compelling visual hook. The "Receipt" visual is a core brand asset, but users currently only see it after ranking a full artist. By bringing these receipts to the landing page in an animated marquee, we can immediately communicate the app's value and visual style.

## Proposed Solution

The system will use a **Static Asset Pre-generation** approach for the landing page to ensure maximum performance and bypass backend rate limits.

1.  **Phase 1: Asset Generation (Script & CI)**
    *   Create a script (`scripts/generate_marquee_assets.py`) that uses the existing `POST /generate-receipt` logic for a curated list of ~24 top artists (8 per column).
    *   **Optimization:** Output files as **WebP** (compressed) for 70% smaller size compared to PNG.
    *   **Theming:** Generate receipts with transparent backgrounds (if supported by the template) or ensure they match the landing page's background color.
    *   **CI/CD:** Integrate the script into the deployment pipeline to regenerate assets whenever the `receipt.html` template is modified.

2.  **Phase 2: Marquee Component (Frontend)**
    *   Develop a `ReceiptMarquee.tsx` component using **Framer Motion**.
    *   **Pattern:** Use the "Duplicate and Offset" method (animate `y` from `0%` to `-50%`) for a seamless, jump-free loop.
    *   **Hardware Acceleration:** Apply `will-change: transform` to the moving columns to promote them to GPU layers.
    *   **Staggered Motion:** Implement 3 columns with different `duration` values (e.g., 20s, 25s, 18s) and alternating directions (up vs. down).

3.  **Phase 3: Integration & UX**
    *   Add the `ReceiptMarquee` to the landing page background.
    *   **Accessibility:** Use the `useReducedMotion()` hook to disable or slow the animation for sensitive users.
    *   **UX:** Pause the animation on hover to allow users to inspect specific receipts.
    *   **Loading:** Use the `priority` prop in `next/image` for the top 2-3 receipts in each column to optimize LCP.

## Technical Considerations

-   **Performance:** Pre-generating static assets is critical. Use `next/image` with proper `sizes` and `quality` (75 is recommended) settings.
-   **VRAM Usage:** Cap at ~24 unique images (8 per column) to prevent excessive memory usage on mobile devices (~30-40MB VRAM).
-   **Animation:** Always use `ease: "linear"` for infinite marquees to avoid robotic acceleration/deceleration.
-   **Fading Edges:** Apply a CSS `mask-image` (linear-gradient) to the top and bottom of the marquee container for a soft, integrated look.

## Acceptance Criteria
- [x] **Parallax Motion:** Multiple columns (at least 3 on desktop) scrolling vertically at different speeds.
- [x] **Infinite Loop:** Seamless scrolling where images wrap around from top to bottom without jumps.
- [x] **High Fidelity:** Receipts use the official template (`receipt.html`) and include artist-specific top 10s and album art.
- [x] **Responsive:**
    - Desktop: 3-4 columns.
    - Tablet: 2 columns.
    - Mobile: 1 column or hidden/static background.
- [x] **Accessibility:** Animation pauses or slows significantly if `prefers-reduced-motion` is detected.
- [x] **Performance:** Landing page load time (LCP) must not increase significantly due to the marquee. Use `next/image` for lazy loading and optimization.


## Success Metrics

-   Increased user engagement (higher click-through rate from landing to "Start Ranking").
-   Positive user feedback on the "modern/cool" aesthetic.

## Dependencies & Risks

-   **Dependency:** `POST /generate-receipt` backend endpoint must be functional and accessible to the generation script.
-   **Risk:** Large number of high-res images could impact mobile performance and data usage. (Mitigation: Use optimized sizes and lazy-load off-screen receipts).

## References & Research

-   **Backend Endpoint:** `app/api/v1/image_generation.py:POST /generate-receipt`
-   **OpenAPI Spec:** `songranker-frontend/openapi.json`
-   **Template:** `app/templates/receipt.html`
-   **Animation Library:** Framer Motion (`framer-motion`)

## Mock Implementation Sketch

### scripts/generate_marquee_assets.py (System Use)
```python
# System script to generate static receipt images for the landing page.
# Uses app/clients/spotify.py to fetch live metadata and cover URLs.
import asyncio
from app.api.v1.image_generation import generate_receipt
from app.schemas.receipt import ReceiptRequest, SongData
from app.clients.spotify import spotify_client

# Hardcoded list of representative artists for the landing page
artist_queries = ["Radiohead", "Taylor Swift", "Kendrick Lamar", "Daft Punk", "The Weeknd"]

async def main():
    for artist_name in artist_queries:
        # 1. Search for artist and get top album/tracks
        # 2. Extract SongData (name, artist, cover_url) from Spotify API response
        # 3. Construct ReceiptRequest
        # 4. Call generate_receipt() and save result to songranker-frontend/public/assets/marquee/
        pass
```

### songranker-frontend/components/ReceiptMarquee.tsx
```tsx
import { motion } from "framer-motion";
import Image from "next/image";

const ReceiptColumn = ({ images, speed, offset }) => (
  <motion.div
    initial={{ y: offset }}
    animate={{ y: [offset, -2000] }}
    transition={{ duration: speed, repeat: Infinity, ease: "linear" }}
    className="flex flex-col gap-4"
  >
    {images.map((src, i) => (
      <Image key={i} src={src} width={400} height={600} alt="Receipt" className="rounded-sm shadow-lg" />
    ))}
    {/* Duplicate list for seamless loop */}
    {images.map((src, i) => (
      <Image key={`dup-${i}`} src={src} width={400} height={600} alt="Receipt" className="rounded-sm shadow-lg" />
    ))}
  </motion.div>
);
```
